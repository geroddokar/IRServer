(function(n,t){t(["./kendo.core"],n)})(function(){return function(n,t){function o(r,u){for(var v=[],k=r.logic||"and",s,y,e,h,l,w,b=r.filters,a=0,p=b.length;a<p;a++)r=b[a],s=r.field,l=r.value,h=r.operator,expression=r.expression,r.filters?r=o(r,u):(w=r.ignoreCase,s=s.replace(/\./g,"/"),r=f[h],u&&(r=c[h]),h==="isnull"||h==="isnotnull"?r=i.format("{0} {1} null",s,r):h==="isempty"||h==="isnotempty"?r=i.format('{0} {1} ""',s,r):r&&l!==t&&(r==="any"?r=expression:(y=n.type(l),y==="string"?(e="'{1}'",l=l.replace(/'/g,"''"),w===!0&&(s="tolower("+s+")")):e=y==="date"?u?"{1:yyyy-MM-ddTHH:mm:ss+00:00}":"datetime'{1:yyyy-MM-ddTHH:mm:ss}'":"{1}",r.length>3?r!=="substringof"?e="{0}({2},"+e+")":(e="{0}("+e+",{2})",h==="doesnotcontain"&&(u?(e="{0}({2},'{1}') eq -1",r="indexof"):e+=" eq false")):e="{2} {0} "+e,r=i.format(e,r,l,s)))),v.push(r);return r=v.join(" "+k+" "),v.length>1&&(r="("+r+")"),r}function s(t){for(var i in t)t[i]instanceof Array&&n.each(t[i],function(n,t){s(t)}),i.indexOf("@odata")===0&&delete t[i]}var i=window.kendo,u=i.data.DataSource,r=n.extend;r(!0,u.fn,{filterEx:function(n){var r=this,i=r._filter;if(n===t)return i;i||(i={filters:[]});JSON.stringify(i.filters)!==JSON.stringify(n)&&r.filter(n)}});var h=u.extend({init:function(n){var s=this,t=n.url,h=n.expand||"",f=!(n.autoId==!1),e=n.transportData,i=n.schema&&n.schema.model&&n.schema.model.id||"Id",o={};o[i]={editable:!f,validation:{required:!f}};n=r(!0,{transport:{read:{url:t+h},create:{url:t,data:e},update:{url:function(n){return t+"('"+n[i]+"')"},data:e},destroy:{url:function(n){return t+"('"+n[i]+"')"}}},schema:{model:{id:i,fields:o}}},n);u.fn.init.call(s,n)},options:{type:"odata-v4",pageSize:10,serverPaging:!0,serverFiltering:!0,serverSorting:!0,requestStart:function(){if(typeof this._getToolbar=="function"){var n=this._getToolbar();n&&n.enable(".k-add-button",!1)}},requestEnd:function(n){if(typeof this._getToolbar=="function"){var i=this,u=i._getToolbar(),t=i._getNotification();if(u&&u.enable(".k-add-button"),t){var f=i.options,e=f.title||"",r=e+"成功！";n.type=="create"?t.success("新增"+r):n.type=="update"?t.success("更新"+r):n.type=="destroy"&&t.success("删除"+r)}}},error:function(n){var t=this;t.showError(n,t._getNotification(),t._getGrid())}},showError:function(t,i,r){function o(t,i,r,u){function l(n){return n.replace(/&amp/g,"&amp;").replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&lt;/g,"<").replace(/&gt;/g,">")}function a(t){return n.parseHTML?n(n.parseHTML(t)):n(t)}var s=!1,e,h;if(t&&u&&u.editable){var o=u.editable.validatable,c=o._errorTemplate,f=u.editable.element.find("input[name='"+t+"']").first();f.length>0&&(f.removeAttr("aria-invalid"),o._errors[t]=i,e=a(c({message:l(i)})),o._decorateMessageContainer(e,t),h=o._findMessageContainer(t).add(f.next(".k-invalid-msg")).hide(),h.replaceWith(e).length||e.insertAfter(f),e.show(),f.attr("aria-invalid",!0),f.toggleClass("k-invalid",!0),s=!0)}!s&&r&&r.error(i)}var u=t.responseJSON||t.xhr.responseJSON,e,f;if(!u)return!1;u.odata&&u.odata.error?(f=u.odata.error.value,o(e,f,i,r)):u.error&&(f=u.error.message,u.error.innererror&&n(u.error.innererror.message.split("\n")).each(function(){if(this.length>0){var n=this.split(" : ");n.length>1?(e=n[0],f=n[1]):f+=n[0];o(e,f,i,r)}}))},_getWidget:function(t,i){if(t){if(t.options&&t.options.name&&t.options.name==i)return t;if(t.selector)return t.data("kendo"+i);if(typeof t=="string")return n(t).data("kendo"+i)}else return null},_getNotification:function(){return this._getWidget(this.options.notification,"Notification")},_getToolbar:function(){return this._getWidget(this.options.toolbar,"ToolBar")},_getGrid:function(){return this._getWidget(this.options.grid,"Grid")}}),f={eq:"eq",neq:"ne",gt:"gt",gte:"ge",lt:"lt",lte:"le",contains:"substringof",doesnotcontain:"substringof",endswith:"endswith",startswith:"startswith",isnull:"eq",isnotnull:"ne",isempty:"eq",isnotempty:"ne",any:"any"},c=r({},f,{contains:"contains"}),e={pageSize:n.noop,page:n.noop,filter:function(n,t,i){t&&t.filters&&t.filters.length&&(n.$filter=o(t,i))},sort:function(t,i){var r=n.map(i,function(n){var t=n.field.replace(/\./g,"/");return n.dir==="desc"&&(t+=" desc"),t}).join(",");r&&(t.$orderby=r)},skip:function(n,t){t&&(n.$skip=t)},take:function(n,t){t&&(n.$top=t)}},l={read:{dataType:"jsonp"}};r(!0,i.data,{EditableDataSource:h,schemas:{"odata-v4":{data:function(t){return(t=n.extend({},t),s(t),t.value)?t.value:[t]}}},transports:{odata:{parameterMap:function(n,t,r){var f,s,u,o;if(n=n||{},t=t||"read",o=(this.options||l)[t],o=o?o.dataType:"json",t==="read"){f={$inlinecount:"allpages"};o!="json"&&(f.$format="json");for(u in n)e[u]?e[u](f,n[u],r):f[u]=n[u]}else{if(o!=="json")throw new Error("Only json dataType can be used for "+t+" operation.");if(t!=="destroy"){for(u in n)s=n[u],typeof s=="number"&&(n[u]=s+"");f=i.stringify(n)}}return f}}}});typeof i.ui.ToolBar!="undefined"&&r(!0,i.ui.ToolBar.fn,{_getItem:function(n){var t,u,i,f=this.options.resizable,r;return t=this.element.find(n),r=t.length?t.data("type"):"",u=t.data(r),u&&u.main&&(t=t.parent("."+SPLIT_BUTTON),r="splitButton",u=t.data(r)),!t.length&&f&&(t=this.popup.element.find(n),r=t.data("type"),i=t.data(r),i&&!i.length&&(i=null)),i&&i.main&&(t=t.parent("."+SPLIT_BUTTON),r="splitButton",i=t.data(r)),u&&f&&(i=u.twin()),{type:r,toolbar:u,overflow:i}}})}(window.kendo.jQuery),window.kendo},typeof define=="function"&&define.amd?define:function(n,t){t()});