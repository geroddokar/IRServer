(function(n,t){t("editor/upload",["editor/import"],n)})(function(){(function(n){var o=window.kendo,s=n.extend,y=n.proxy,t=o.ui.editor,u=t.EditorUtils,i=t.Dom,f=t.ImportCommand,h=t.Tool,c=u.registerTool,l=t.ToolTemplate,r=t.RangeUtils,a=t.LinkFormatter,v=r.textNodes,e=f.extend({init:function(n){var t=this;f.fn.init.call(t,n);t.formatter=new a;t.async=!0;t.attributes={}},insertFile:function(n,t){var u=this.attributes,f=r.documentFromRange(t);if(u.href&&u.href!="http://")if(n)i.attr(n,u);else return n=i.create(f,"a",{href:u.href}),n.innerHTML=u.innerHTML,t.deleteContents(),t.insertNode(n),n.nextSibling||i.insertAfter(f.createTextNode("﻿"),n),t.setStartAfter(n),t.setEndAfter(n),r.selectRange(t),!0;return!1},insertImage:function(n,t){var u=this.attributes,e=r.documentFromRange(t),f;if(u.src&&u.src!="http://")if(f=function(){setTimeout(function(){u.width||n.removeAttribute("width");u.height||n.removeAttribute("height");n.removeAttribute("complete")})},n)n.onload=n.onerror=f,i.attr(n,u),f();else return n=i.create(e,"img",u),n.onload=n.onerror=f,t.deleteContents(),t.insertNode(n),n.nextSibling||i.insertAfter(e.createTextNode("﻿"),n),f(),t.setStartAfter(n),t.setEndAfter(n),r.selectRange(t),!0;return!1},redo:function(){var n=this,t=n.lockRange();this.formatter.apply(t,this.attributes);n.releaseRange(t)},_onUploadSuccess:function(n){var t=this,u=n.response.path,i=t.getRange(),e=t.editor,o,f,s;e.options.tool=="insertImage"?(o=r.image(i),t.attributes={src:u,height:e.options.imageHeight},t.insertImage(o,i)):(f=v(i),s=f.length?this.formatter.finder.findSuitable(f[0]):null,t.attributes={href:u,innerHTML:u},t.insertFile(s,i));t._trigger("success",n)},_onUploadSelect:function(n){if(this._trigger("select",n),n.files[0].validationErrors){var i=n.files[0].validationErrors[0],t={invalidMaxFileSize:"文件超过最大限制。",invalidMinFileSize:"文件低于最小限制。",invalidFileExtension:"不支持的文件类型。"},r=t[i]||t.invalidFileExtension;alert(r)}else this._initLoadingOverlay()}});s(t,{UploadCommand:e});c("upload",new h({command:e,template:new l({template:u.buttonTemplate,title:"上传"})}))})(window.kendo.jQuery)},typeof define=="function"&&define.amd?define:function(n,t,i){(i||t)()}),function(n,t){t(["./kendo.editor"],n)}(function(){return function(n,t){var i=window.kendo,r=i.ui,u=r.Editor,e=i.support.mobileOS,f=i.support.browser,s=n.extend,h=n.proxy,o=u.extend({init:function(t,r){var e=this,r=r||{},p=r.field,c=r.tool||"insertImage",o=r.multipleInsert||!1,w=r.multipleUpload||!0,d=r.multipleDetele||!0,s=r.fileTypes||"*.png,*.jpg,*.gif",f=r.url||i.ui.options.url||"/api/Oss",l=r.fileUrl||i.ui.options.fileUrl,b=r.imageUrl||i.ui.options.imageUrl||l,k=r.thumbnailUrl||i.ui.options.thumbnailUrl||f.trimEnd("/")+"/Thumbnail",a=r.browserDialogOpen||i.ui.options.browserDialogOpen||null,h=r.editorOptions||null,v=n.extend(!0,{read:{url:f.trimEnd("/")+"/Read",type:"GET",data:{searchPattern:s}},destroy:{url:f.trimEnd("/")+"/Delete",type:"POST"},create:{url:f.trimEnd("/")+"/Create",type:"POST"},uploadUrl:f.trimEnd("/")+"/Save",fileUrl:l,imageUrl:b,thumbnailUrl:k},r.transport),y={fileTypes:s,transport:v};r=n.extend(!0,{height:105,imageHeight:100,"import":{proxyUrl:v.uploadUrl+"?md5=true",allowedExtensions:s.replace(/\*/g,"").split(",")},tool:c,tools:[{name:"upload",exec:function(){if(!o){var t=n(this).data("kendoEditor"),i=t.createRange();i.selectNodeContents(t.body);t.selectRange(i)}}},{name:c,exec:function(){if(!o){var t=n(this).data("kendoEditor"),i=t.createRange();i.selectNodeContents(t.body);t.selectRange(i)}}},{name:"cleanFormatting",tooltip:"删除",exec:function(t){var i,r;t.preventDefault();t.stopPropagation();i=n(this).data("kendoEditor");o||(r=i.createRange(),r.selectNodeContents(i.body),i.selectRange(r),h&&(h.model[p]="",h.model.dirty=!0));i.exec("inserthtml",{value:""})}}],imageBrowser:y,fileBrowser:y,dialogOptions:{open:function(t){var i=this.element,u=n(".k-filebrowser",i).data("kendoFileBrowser"),f=n(".k-imagebrowser",i).data("kendoImageBrowser"),r=n(".k-upload input",i).data("kendoUpload");n(".k-edit-label",i).each(function(t,i){var r=n(i),f=r.next(".k-edit-field"),e=r.children("label"),u=e.attr("for");r.attr("label-container-for",u);f.attr("data-container-for",u)});n("#k-editor-image-height",i).val(100).attr("readonly",!0);r.setOptions({multiple:w});typeof a=="function"&&a.call(this,t)}}},r);r.name="Editor";u.fn.init.call(e,t,r);n(e.body).attr("contenteditable",!1);r.height&&e.wrapper.find(".k-editable-area").height(r.height)},options:{name:"ResourceEditor"},value:function(u){var f=this;if(u===t)return f.options.tool=="insertImage"?n(f.body).find("img").map(function(){return n(this).attr("src")}).toArray().join(";"):n(f.body).find("a").map(function(){return n(this).attr("href")}).toArray().join(";");u===r.editor.emptyElementContent&&(u="");u=u&&u.split(";").map(function(n){return f.options.tool=="insertImage"?i.format('<img alt="" height="{0}" src="{1}">',f.options.imageHeight,n):i.format('<a href="{0}">{0}<\/a>',n)}).join("");i.ui.Editor.fn.value.call(f,u)},exec:function(t,r){var u=this,s,e,f=null,c=n.extend,l=n.proxy,h=i.ui.Editor,o;if(!t)throw new Error("kendoEditor.exec(): `name` parameter cannot be empty");if(t=t.toLowerCase(),u.keyboard.isTypingInProgress()||u.restoreSelection(),e=u.toolbar.toolById(t),!e)for(o in h.defaultTools)if(o.toLowerCase()==t){e=h.defaultTools[o];break}if(e){if(s=u.getRange(),e.command&&(f=e.command(c({range:s},r))),u.trigger("execute",{name:t,command:f}),/^(undo|redo)$/i.test(t))u.undoRedoStack[t]();else if(f&&(f.managesUndoRedo||u.undoRedoStack.push(f),f.editor=u,f.exec(),f.async)){f.change=l(u._selectionChange,u);return}u._selectionChange()}},_createContentElement:function(t){var o=this,r,h,u,s=o.textarea,l=o.options.domain,a=l||document.domain,c="",v='javascript:""';(l||a!=location.hostname)&&(c='<script>document.domain="'+a+'"<\/script>',v="javascript:document.write('"+c+"')");s.hide();r=n("<iframe />",{title:o.options.messages.editAreaTitle,frameBorder:"0"})[0];n(r).css("display","").addClass("k-content").attr("tabindex",s[0].tabIndex).insertBefore(s);r.src=v;h=r.contentWindow||r;u=h.document||r.contentDocument;n(r).one("load",function(){o.toolbar.decorateFrom(u.body)});return u.open(),u.write("<!DOCTYPE html><html><head><meta charset='utf-8' /><style>html,body{padding:0;margin:0;height:100%;min-height:100%;}body{box-sizing:border-box;font-size:12px;font-family:Verdana,Geneva,sans-serif;word-wrap: break-word;-webkit-nbsp-mode: space;-webkit-line-break: after-white-space;"+(i.support.isRtl(s)?"direction:rtl;":"")+(f.msie||f.edge?"height:auto;":"")+(e.ios?"word-break:break-all;":"")+"}h1{font-size:2em;margin:.67em 0}h2{font-size:1.5em}h3{font-size:1.16em}h4{font-size:1em}h5{font-size:.83em}h6{font-size:.7em}p{margin:0 0 1em;}.k-marker{display:none;}.k-paste-container,.Apple-style-span{position:absolute;left:-10000px;width:1px;height:1px;overflow:hidden}ul,ol{padding-left:2.5em}span{-ms-high-contrast-adjust:none;}a{color:#00a}code{font-size:1.23em}telerik\\3Ascript{display: none;}.k-table{width:100%;border-spacing:0;margin: 0 0 1em;}.k-table td{min-width:1px;padding:.2em .3em;}.k-table,.k-table td{outline:0;border: 1px dotted #ccc;}.k-table p{margin:0;padding:0;}.k-column-resize-handle-wrapper {position: absolute; height: 10px; width:10px; cursor: col-resize; z-index: 2;}.k-column-resize-handle {width: 100%; height: 100%;}.k-column-resize-handle > .k-column-resize-marker {width:2px; height:100%; margin:0 auto; background-color:#00b0ff; display:none; opacity:0.8;}.k-row-resize-handle-wrapper {position: absolute; cursor: row-resize; z-index:2; width: 10px; height: 10px;}.k-row-resize-handle {display: table; width: 100%; height: 100%;}.k-row-resize-marker-wrapper{display: table-cell; height:100%; width:100%; margin:0; padding:0; vertical-align: middle;}.k-row-resize-marker{margin: 0; padding:0; width:100%; height:2px; background-color: #00b0ff; opacity:0.8; display:none;}.k-table-resize-handle-wrapper {position: absolute; background-color: #fff; border: 1px solid #000; z-index: 100; width: 5px; height: 5px;}.k-table-resize-handle {width: 100%; height: 100%;}.k-table-resize-handle.k-resize-east{cursor:e-resize;}.k-table-resize-handle.k-resize-north{cursor:n-resize;}.k-table-resize-handle.k-resize-northeast{cursor:ne-resize;}.k-table-resize-handle.k-resize-northwest{cursor:nw-resize;}.k-table-resize-handle.k-resize-south{cursor:s-resize;}.k-table-resize-handle.k-resize-southeast{cursor:se-resize;}.k-table-resize-handle.k-resize-southwest{cursor:sw-resize;}.k-table-resize-handle.k-resize-west{cursor:w-resize;}.k-table.k-table-resizing{opacity:0.6;}k\\:script{display:none;}<\/style>"+c+"<script>(function(d,c){d[c]('header'),d[c]('article'),d[c]('nav'),d[c]('section'),d[c]('footer');})(document, 'createElement');<\/script>"+n.map(t,function(n){return"<link rel='stylesheet' href='"+n+"'>"}).join("")+"<\/head><body autocorrect='off' contenteditable='true'><\/body><\/html>"),u.close(),h}});r.plugin(o)}(window.kendo.jQuery),window.kendo},typeof define=="function"&&define.amd?define:function(n,t){t()}),function(n,t){var r=window.kendo,f=n.extend,i=r.ui.editor,l=i.EditorUtils,a=i.Dom,v=l.registerTool,y=i.ToolTemplate,e=i.RangeUtils,p=i.Command,o=r.keys,u="#k-editor-image-url",s="#k-editor-image-title",h="#k-editor-image-width",c="#k-editor-image-height";f(!0,i.ImageCommand.fn,{exec:function(){function k(t){var r=l.element,f=parseInt(r.find(h).val(),10),e=parseInt(r.find(c).val(),10),o=n._imageBrowser.path();n.attributes={src:r.find(u).val().replace(/ /g,"%20"),alt:r.find(s).val()};n.attributes.width=null;n.attributes.height=null;!isNaN(f)&&f>0&&(n.attributes.width=f);!isNaN(e)&&e>0&&(n.attributes.height=e);d=n.insertImage(i,y);w(t);n.change&&n.change();sessionStorage.setItem("kendo.ui.ImageBrowser.path",o)}function w(t){t.preventDefault();l.destroy();a.windowFromDocument(e.documentFromRange(y)).focus();d||n.releaseRange(y)}function rt(n){n.keyCode==o.ENTER?k(n):n.keyCode==o.ESC&&w(n)}var n=this,y=n.lockRange(),d=!1,i=e.image(y),nt=i&&i.getAttribute("width")||"",tt=i&&i.getAttribute("height")||"",l,g=n.editor.options,it=g.messages,p=g.imageBrowser,v=!!(r.ui.ImageBrowser&&p&&p.transport&&p.transport.read!==t),b={title:it.insertImage,visible:!1,resizable:v};b.close=w;v&&(b.width=750);l=this.createDialog(n._dialogTemplate(v),b).toggleClass("k-filebrowser-dialog",v).find(".k-dialog-insert").click(k).end().find(".k-dialog-close").click(w).end().find(".k-edit-field input").keydown(rt).end().find(u).val(i?i.getAttribute("src",2):"http://").end().find(s).val(i?i.alt:"").end().find(h).val(nt).end().find(c).val(tt).end().data("kendoWindow");v&&(this._imageBrowser=new r.ui.ImageBrowser(l.element.find(".k-imagebrowser"),f({},p,{path:sessionStorage.getItem("kendo.ui.ImageBrowser.path")||"/",change:function(){l.element.find(u).val(this.value())},apply:k})));l.center().open();l.element.find(u).focus().select()}})}(window.kendo.jQuery),function(n,t){var r=window.kendo,f=n.extend,i=r.ui.editor,h=i.EditorUtils,c=i.Dom,a=h.registerTool,v=i.ToolTemplate,e=i.RangeUtils,y=i.Command,p=i.LinkFormatter,l=e.textNodes,o=r.keys,u="#k-editor-file-url",s="#k-editor-file-title";f(!0,i.FileCommand.fn,{exec:function(){function b(t){var r=i.element,f=r.find(u).val().replace(/ /g,"%20"),e=r.find(s).val(),o=n._fileBrowser.path();n.attributes={href:f,innerHTML:e!==""?e:f};d=n.insertFile(h,v);p(t);n.change&&n.change();sessionStorage.setItem("kendo.ui.FileBrowser.path",o)}function p(t){t.preventDefault();i.destroy();c.windowFromDocument(e.documentFromRange(v)).focus();d||n.releaseRange(v)}function tt(n){n.keyCode==o.ENTER?b(n):n.keyCode==o.ESC&&p(n)}var n=this,v=n.lockRange(),k=l(v),d=!1,h=k.length?this.formatter.finder.findSuitable(k[0]):null,i,g=n.editor.options,nt=g.messages,y=g.fileBrowser,a=!!(r.ui.FileBrowser&&y&&y.transport&&y.transport.read!==t),w={title:nt.insertFile,visible:!1,resizable:a};w.close=p;a&&(w.width=750);i=this.createDialog(n._dialogTemplate(a),w).toggleClass("k-filebrowser-dialog",a).find(".k-dialog-insert").click(b).end().find(".k-dialog-close").click(p).end().find(".k-edit-field input").keydown(tt).end().find(u).val(h?h.getAttribute("href",2):"http://").end().find(s).val(h?h.title:"").end().data("kendoWindow");a&&(n._fileBrowser=new r.ui.FileBrowser(i.element.find(".k-filebrowser"),f({},y,{path:sessionStorage.getItem("kendo.ui.FileBrowser.path")||"/",change:function(){i.element.find(u).val(this.value())},apply:b})));i.center().open();i.element.find(u).focus().select()}})}(window.kendo.jQuery);